---

- name: Gathering packages facts
  hosts: [all]
  tasks:
    - name: fetch packages information
      package_facts:
        manager: auto
  tags:
    - system
    - user

- name: Configure system
  hosts: [all]
  roles:
    - locales
    - packages/apt-debian
    - common/configuration
    - common/upgrade
    - common/hardware
    - packages/sshd
    - user/setup
    - packages/sudo
    - packages/common
    - packages/desktop
    - packages/firefox
    - packages/dropbox
#     - packages/sublime
    - packages/python
    - packages/virtualization
    - packages/dbeaver
    - packages/development/toolbox
    - packages/development/java
    - packages/development/docker
#     - packages/development/javascript
    - packages/audible
    - user/config
    - user/zsh
    - packages/intellij
  vars:
    locales:
      - fr_CH.UTF-8
      - en_US.UTF-8
      - en_CA.UTF-8
    debian_releases:
      - name: testing
        priority: 800
        security: yes
      - name: unstable
        priority: -1
        security: no
    user_preferences: yes
  tags:
    - system

- name: Configure user environment
  hosts: [all]
  roles:
    - user-packages/desktop
    - user-packages/pyenv
    - user-packages/pipsi
    - user-packages/dropbox
  tags:
    - user
